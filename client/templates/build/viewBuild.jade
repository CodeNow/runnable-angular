nav.sub-header
  h1.build-header.divided-header.animations-off(
    ng-class = "{'in': !dataBuild.data.isClean }"
  )
    button.btn-icon.silver.tooltip(
      data-title = "View All Builds"
      ng-click = "dataBuild.actions.stateToBuildList()"
      type = "button"
    )
      svg.iconnables.icons-back-table
        use(xlink:href = "#icons-back-table")
    .iconnables.iconnables-container
      svg.iconnables.icons-check
        use(xlink:href = "#icons-check")
      svg.iconnables.icons-asterisk
        use(xlink:href = "#icons-asterisk")
    | Build {{ dataBuild.data.build.attrs.id | limitTo:4 }}...

  //- all buttons should be disabled during a build
  section#main-controls(ng-class = "{in: !dataBuild.data.isClean}")
    .clean(ng-class = "{in: dataBuild.data.showBuildOptionsClean}")
      //- on failed builds, run instance needs to be disabled
      button.orange(
        ng-click = "dataBuild.actions.runInstance()"
        ng-disabled = "dataBuild.data.build.failed()"
        type = "button"
      ) Run Instance
      .btn-group
        button.silver(
          ng-click = "dataBuild.actions.rebuild()"
          ng-disabled = "!dataBuild.data.build.attrs.completed"
          type = "button"
        ) Rebuild
        a.btn.silver.btn-icon(
          ng-class = "{active: dataBuild.data.showBuildOptionsClean}"
          ng-disabled = "!dataBuild.data.build.attrs.completed"
          toggle-pop-over
          toggle-pop-over-model = "dataBuild.data.showBuildOptionsClean"
        )
          svg.iconnables.icons-arrow-down
            use(xlink:href = "#icons-arrow-down")
          pop-over(
            actions = "{\
              getPopoverButtonText: dataBuild.actions.getPopoverButtonText,\
              resetInputModelValue: dataBuild.actions.resetInputModelValue\
            }"
            data = "{\
              buildName: dataBuild.data.buildName,\
              show: dataBuild.data.showBuildOptionsClean\
            }"
            template = "viewBuildPopoverBuildOptions"
          )
    .dirty(ng-class = "{in: dataBuild.data.showBuildOptionsDirty}")
      .btn-group
        button.green(
          type = "button"
          ng-click = "dataBuild.actions.build()"
        ) Build
        a.btn.green.btn-icon(
          ng-class = "{active: dataBuild.data.showBuildOptionsDirty}"
          toggle-pop-over
          toggle-pop-over-model = "dataBuild.data.showBuildOptionsDirty"
        )
          svg.iconnables.icons-arrow-down
            use(xlink:href = "#icons-arrow-down")
          pop-over(
            actions = "{\
              getPopoverButtonText: dataBuild.actions.getPopoverButtonText,\
              resetInputModelValue: dataBuild.actions.resetInputModelValue\
            }"
            data = "{\
              buildName: dataBuild.data.buildName,\
              show: dataBuild.data.showBuildOptionsDirty\
            }"
            template = "viewBuildPopoverBuildOptions"
          )
      button.silver(
        ng-click = "dataBuild.actions.discardChanges()"
        type = "button"
      ) Discard Changes

section.sidebar
  ul(ng-show = "dataBuild.data.build.attrs.created")
    li
      svg.iconnables.icons-recipe
        use(xlink:href = "#icons-recipe")
      b {{ dataApp.stateParams.branchName }}
      | #{''} config
    li(ng-show = "dataBuild.data.build.attrs.completed")
      svg.iconnables.icons-duration
        use(xlink:href = "#icons-duration")
<<<<<<< HEAD
      | Built in {{ (dataBuild.data.build.buildTime() / 1000) | number:2 }} seconds
    li
=======
      | Built in {{ dataBuild.data.build.buildTime() | number:2 }} seconds
    li(ng-show = "dataBuild.data.build.attrs.started")
>>>>>>> master
      svg.iconnables.icons-calendar
        use(xlink:href = "#icons-calendar")
      | Initiated {{ dataBuild.data.build.attrs.created | timeAgo }}
    li
      svg.iconnables.icons-trigger
        use(xlink:href = "#icons-trigger")
      | Triggered by <a>{{ dataBuild.data.build.user.attrs.accounts.github.username }}</a>
  h3 Message Log
  ol#messages
    li(ng-repeat = "commit in dataBuild.data.commits")
      ol.message
        li
          a {{commit.message}}
        li
          a
            img
            | #{''} {{commit.username}}
          span {{commit.hash}}
    li
      ol.message
        li
          a removing comment
        li
          a
            img(
              height = "20"
              src = "https://avatars0.githubusercontent.com/u/467885?s=64"
              width = "20"
            )
            |&nbsp;cflynn07
          a 37a8f1
            svg.iconnables.icons-git
              use(xlink:href = "#icons-git")
    li
      ol.message
        li
          a separate popover for branches
        li
          a
            img(
              height = "20"
              src = "http://www.gravatar.com/avatar/49fa96bd569083f739e8f8e37264b6fc?s=64"
              width = "20"
            )
            |&nbsp;prafulrana
          a 37a8f1
            svg.iconnables.icons-git
              use(xlink:href = "#icons-git")
    li
      ol.message
        li
          a change project popover
        li
          a
            img(
              height = "20"
              src = "http://www.gravatar.com/avatar/452e4a4c93d2ffba9999b03cea258206?s=64"
              width = "20"
            )
            |&nbsp;runnabro
          a 37a8f1
            svg.iconnables.icons-git
              use(xlink:href = "#icons-git")
    li
      ol.message
        li
          a remove sign up, new, search from header
        li
          a
            img(
              height = "20"
              src = "http://www.gravatar.com/avatar/452e4a4c93d2ffba9999b03cea258206?s=64"
              width = "20"
            )
            |&nbsp;runnabro
          a 37a8f1
            svg.iconnables.icons-git
              use(xlink:href = "#icons-git")
    li
      ol.message
        li
          a sync with tony
        li
          a
            img(
              height = "20"
              src = "https://avatars0.githubusercontent.com/u/467885?s=64"
              width = "20"
            )
            |&nbsp;cflynn07
          a 37a8f1
            svg.iconnables.icons-git
              use(xlink:href = "#icons-git")

//- code_editor
#editor(
  ng-class="{'in': dataBuild.data.showExplorer}"
)
  aside#explorer
    #controls
      button.toggle-theme.tooltip(
        data-title = "Change Theme"
        ng-class = "{dark: !dataBuild.data.toggleTheme, light: dataBuild.data.toggleTheme}"
        ng-click = "dataBuild.data.toggleTheme = !dataBuild.data.toggleTheme"
      )
        .theme
    //- h6(ng-if = "buildFiles.models.length")
    h6.explorer-header
      | CONFIG FILES
      a.btn.silver.btn-sm.file-explorer-menu.btn-icon(
        ng-class = "{active: data.showFileMenu}"
        toggle-pop-over
        toggle-pop-over-model = "data.showFileMenu"
      )
        svg.iconnables.icons-gear
          use(xlink:href = "#icons-gear")
        pop-over(
          template = "viewBuildPopoverFileMenu"
          actions = "{\
            createFile: actions.createFile\
          }"
          data = "{\
            showAddRepo: data.showAddRepo,\
            showForm: data.showForm,\
            show: data.showFileMenu\
          }"
        )
    file-tree(
      open-files = "dataBuild.data.openFiles"
      version = "dataBuild.data.version"
      is-clean = "dataBuild.data.isClean"
    )
    h6.explorer-header
      | REPOSITORIES
      a.btn.silver.btn-sm.file-explorer-menu.btn-icon(
        ng-class = "{active: dataBuild.data.showRepoMenu}"
        toggle-pop-over
        toggle-pop-over-model = "dataBuild.data.showRepoMenu"
      )
        svg.iconnables.icons-gear
          use(xlink:href = "#icons-gear")
        pop-over(
          actions = "{}"
          data = "{\
            show: dataBuild.data.showRepoMenu\
          }"
          template = "viewBuildPopoverRepoMenu"
        )
    ul.repo-tree
      //- for "edit mode":
      //- * delete/editmode entered via context menu
      //- * add class .active to <li> (class should be applied while context menu is open)
      //- * remove readonly property from input and select all text
      //- * save on blur or enter key
      li(ng-repeat = "repoModel in dataBuild.data.version.attrs.appCodeVersions")
        span
          svg.iconnables.icons-git.filetypes
            use(xlink:href = "#icons-git")
          | {{ repoModel.attrs.repo }}
        input.tree-input(
          placeholder = "Specify Branch or SHA"
          readonly
          value = "{{ repoModel.attrs.commit }}"
        )

  button#explorer-toggle.btn-icon(
    ng-click = "dataBuild.actions.toggleExplorer()"
    type = "button"
  )
    svg.iconnables.icons-folder-open
      use(xlink:href = "#icons-folder-open")

  tabs(
    open-files = "dataBuild.data.openFiles"
  )
  tabs-dropdown(
    open-files = "dataBuild.data.openFiles"
  )
  active-panel(
    open-files = "dataBuild.data.openFiles"
    is-clean = "dataBuild.data.isClean"
    is-dark-theme = "dataBuild.data.toggleTheme"
  )

//- logs
build-stream(
  ng-class = "{out: dataBuild.data.closed}"
)
