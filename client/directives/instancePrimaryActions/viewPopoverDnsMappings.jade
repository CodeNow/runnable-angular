.popover.bottom.popover-dns-mappings(
  ng-class = "{'in': active}"
  ng-init = "\
    dnsMappings = [\
      {name: 'data-dog', elasticHostname: 'datadog-staging-CodeNow.runnableapp.com', branch: 'master', sandbox: 'runnabro', status: 'green'},\
      {name: 'mavis', elasticHostname: 'mavis-staging-CodeNow.runnableapp.com', branch: 'master', sandbox: 'CodeNow', status: 'green'},\
      {name: 'neo4j', elasticHostname: 'neo4j-staging-CodeNow.runnableapp.com', branch: 'master', sandbox: 'CodeNow', status: 'green'},\
      {name: 'optimus', elasticHostname: 'optimus-staging-CodeNow.runnableapp.com', branch: 'master', sandbox: 'CodeNow', status: 'green'},\
      {name: 'runnable-angular', elasticHostname: 'runnable-angular-staging-CodeNow.runnableapp.com', branch: 'master', sandbox: 'CodeNow', status: 'green'}\
    ];\
    mavisBranches = [\
      {name: 'master', status: 'green'},\
      {name: 'abort-on-uncaught-exception', status: 'gray'},\
      {name: 'bypass-prev-dock', status: 'orange'},\
      {name: 'no-docks-404', status: 'red'},\
      {name: 'remove-numBuild', status: 'green'},\
      {name: 'temporary-branch-to-fork-on-runnable', status: 'green'}\
    ];\
  "
  ng-style = "popoverStyle.getStyle()"
)
  //- arrow is white if loading or no dns mappings
  .arrow(
    ng-class = "{'white': state.loading || state.empty}"
  )
  animated-panel-container.popover-views(
    ng-if = "$root.featureFlags.isolationUI"
  )
    animated-panel(
      default = "true"
      name = "dnsOverview"
    )
      .popover-view(
        ng-init = "\
          state.loading = true;\
          state.empty = true;\
        "
        ng-style = "state.loading && {'display': 'block'}"
      )
        //- only show the header if not loading and not empty
        .popover-header.load(
          ng-if = "!state.loading && !state.empty"
        )
          .fade(
            ng-class = "{'in': isActivePanel()}"
          ) DNS Mappings

        //- spinner when loading
        .spinner-wrapper.spinner-sm.spinner-gray.spinner-center.in(
          ng-click = "state.loading = false"
          ng-if = "state.loading"
          ng-include = "'spinner'"
        )

        //- empty state if not loading and empty
        .popover-content(
          ng-click = "state.empty = false"
          ng-if = "!state.loading && state.empty"
        )
          p.p.empty.text-center.fade-in DNS Mappings are created with elastic hostnames in Environment Variables or Find & Replace.&#32;
            a.link(
              href = "#"
              target = "_blank"
            ) Learn more
            | .

        //- begin dns mappings
        .popover-content.fade(
          ng-class = "{'in': isActivePanel()}"
          ng-if = "isActivePanel && !state.empty"
        )

          //- list of DNS mappings
          ul.list.popover-list
            li.list-item.popover-list-item.tr.multi-line.clearfix.load(
              ng-click = "\
                dnsMappings.currentIndex = $index;\
                goToPanel('dnsList');\
                state.selectedMapping = container;\
              "
              ng-if = "!state.loading"
              ng-repeat = "container in dnsMappings"
            )
              .cell.text-overflow(
                title = "{{container.name}}"
              )
                .text-overflow {{container.name}}
                small.small.text-overflow(
                  title = "{{container.elasticHostname}}"
                ) {{container.elasticHostname}}
              .cell.text-overflow(
                ng-class = "{'fade-in': container === state.selectedMapping && isActivePanel()}"
              )
                .icons-status(
                  ng-class = "container.status"
                  title = "{{container.branch}}"
                  tooltip
                  tooltip-eval = "instance | cardBuildStatusTitle"
                  tooltip-options = "{\"class\":\"bottom\",\"left\":-7,\"top\":12}"
                )
                | {{container.branch}}
                small.small.text-overflow(
                  title = "{{container.sandbox}}"
                ) {{container.sandbox}}

              //- inline for svg animation
              svg.iconnables.icons-check.float-right(
                ng-if = "container === state.selectedMapping && isActivePanel()"
                viewbox = '0 0 14.5 10'
              )
                path.path(
                  d = 'M1,4.5L5.5,9l8-8'
                  fill = 'none',
                  stroke = '#3ccb5a',
                  stroke-linecap = 'round',
                  stroke-linejoin = 'round',
                  stroke-miterlimit = '10',
                  stroke-width = '2',
                )

              svg.iconnables.icons-arrow-forward.float-right(
                ng-class = "{'in': container === state.selectedMapping && isActivePanel()}"
              )
                use(
                  xlink:href = "#icons-arrow-down"
                )

    animated-panel(
      name = "dnsList"
    )
      //- view for changing a dns mapping
      .popover-view
        .popover-header
          svg.btn.btn-sm.iconnables.icons-arrow-backward.fade(
            ng-class = "{'in': isActivePanel()}"
            ng-click = "\
              goToPanel('dnsOverview', 'back');\
              state.selectedMapping = null;\
            "
          )
            use(
              xlink:href = "#icons-arrow-down"
            )
          .fade(
            ng-class = "{'in': isActivePanel()}"
          ) {{dnsMappings[dnsMappings.currentIndex].name}} Containers

        .popover-content.fade(
          ng-class = "{'in': isActivePanel()}"
        )
          //- organization container list
          ul.list.popover-list
            //- .no-touching if the branch and sandbox is currently selected
                also show .icons-fat-check if ^

                ** mousedown/up are only to demonstrate the loading/fail state...we don't actually want that to trigger a spinner
            li.list-item.popover-list-item.text-overflow(
              ng-class = "{'no-touching': dnsMappings[dnsMappings.currentIndex].branch === branch.name && dnsMappings[dnsMappings.currentIndex].sandbox === 'CodeNow'}"
              ng-click = "\
                dnsMappings[dnsMappings.currentIndex].branch = branch.name;\
                dnsMappings[dnsMappings.currentIndex].sandbox = 'CodeNow';\
                dnsMappings[dnsMappings.currentIndex].status = branch.status;\
                dnsMappings[dnsMappings.currentIndex].type = 'organization';\
                goToPanel('dnsOverview', 'back');\
              "
              ng-mousedown = "branch.selectFailed = true"
              ng-mouseup = "branch.selectFailed = false"
              ng-repeat = "branch in mavisBranches"
            )
              //- from status-icon template
              .icons-status(
                ng-class = "branch.status"
                tooltip
                tooltip-eval = "instance | cardBuildStatusTitle"
                tooltip-options = "{\"class\":\"bottom\",\"left\":-7,\"top\":12}"
              )
              | {{branch.name}}

              //- when currently selected
              svg.iconnables.icons-fat-check.float-right(
                ng-if = "dnsMappings[dnsMappings.currentIndex].branch === branch.name && dnsMappings[dnsMappings.currentIndex].sandbox === 'CodeNow'"
              )
                use(
                  xlink:href = "#icons-fat-check"
                )

              //- spinner when loading (likely fail?)
              .spinner-wrapper.spinner-sm.spinner-gray.in.float-right(
                ng-if = "branch.selectFailed"
                ng-include = "'spinner'"
              )