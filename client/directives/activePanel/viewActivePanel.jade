//- tabs
.views-tabs(
  open-items = "openItems"
  instance = "instance"
  tabs
)

//- toolbar
.views-toolbar-wrapper(
  ng-class = "{\
    'toolbar-lg': (showBuildFailurePrompt() || shouldShowUpdateConfigsPrompt) && $root.featureFlags.saveToolbar,\
    'ace-runnable-dark': !$root.featureFlags.imAfraidOfTheDark,\
    'ace-runnable-light': $root.featureFlags.imAfraidOfTheDark\
  }"
  ng-if = "\
    showBuildFailurePrompt() || \
    shouldShowUpdateConfigsPrompt || \
    $root.featureFlags.saveToolbar\
  "
  ng-include = "'viewToolbar'"
)

//- active panel
.active-panel(
  ng-class = "{\
    'ace-runnable-dark': !$root.featureFlags.imAfraidOfTheDark,\
    'ace-runnable-light': $root.featureFlags.imAfraidOfTheDark\
  }"
  ng-repeat = "item in openItems.models"
  ng-show = "item === openItems.activeHistory.last()"
)

  .floating-controls(
    ng-if = "$root.featureFlags.fullScreenToggle || $root.featureFlags.themeToggle"
    ng-include = "'viewFloatingControls'"
  )

  //- logs
  .term-js.term-log(
    log-term
    ng-controller = "BuildLogController"
    ng-if = "item.state.type === 'BuildStream' && !$root.featureFlags.updatedBuildLogs"
  )

  .build-log-wrapper(
    build-logs
    instance = 'instance'
    ng-class = "{\
      'logs-runnable-dark': !$root.featureFlags.imAfraidOfTheDark,\
      'logs-runnable-light': $root.featureFlags.imAfraidOfTheDark\
    }"
    ng-if = "item.state.type === 'BuildStream' && $root.featureFlags.updatedBuildLogs && instance"
    ng-style = "($root.featureFlags.themeToggle || $root.featureFlags.fullScreenToggle) && {'padding-right': '42px'}"
  )

  .term-js.term-log(
    log-term
    ng-controller = "BoxLogController"
    ng-if = "item.state.type === 'LogView'"
  )

  //- terminal
  .term-js(
    log-term
    ng-controller = "TermController"
    ng-if = "item.state.type === 'Terminal'"
  )

  //- files
  .ace-container(
    file = "item"
    file-editor
    loading = "loading"
    ng-if = "item.state.type === 'File'"
    use-auto-update = "useAutoUpdate"
  )

  div(
    current-model = "instance.attrs"
    env-vars
    ng-if = "item.state.type === 'EnvVars'"
    state-model = "stateModel"
    validation = "validation.env"
  )
    span.js-char-width 0

//- blank state
.blank-panel(
  ng-class = "{\
    'ace-runnable-dark': !$root.featureFlags.imAfraidOfTheDark,\
    'ace-runnable-light': $root.featureFlags.imAfraidOfTheDark\
  }"
  ng-if= "openItems.models.length === 0"
)
  .floating-controls(
    ng-include = "'viewFloatingControls'"
  )

  ul.blank-panel-group
    li.btn.btn-sm(
      ng-click = "openItems.addTerminal()"
    )
      svg.iconnables
        use(
          xlink:href = "#icons-start-cmd"
        )
      | Terminal
    li.btn.btn-sm(
      ng-click = "openItems.addBuildStream()"
    )
      svg.iconnables
        use(
          xlink:href = "#icons-build-logs"
        )
      | Build Logs
    li.btn.btn-sm(
      ng-click = "openItems.addLogs()"
    )
      svg.iconnables.icons-server
        use(
          xlink:href = "#icons-cmd-logs"
        )
      | CMD Logs