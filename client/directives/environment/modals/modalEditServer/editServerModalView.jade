form.modal-dialog.modal-edit(
  name = "editServerForm"
  ng-class = "{\
    'ace-active': (selectedTab === 'buildfiles' || selectedTab === 'env'),\
    'disabled': building || isLoading.editServerModal,\
    'xl': (selectedTab === 'buildfiles' || selectedTab === 'env' || selectedTab === 'logs')\
  }"
)
  header.modal-header
    server-status-card-header.btn.btn-sm.btn-title(
      ng-if = "!$root.featureFlags.cardStatus"
      no-touching = "true"
    )
    div(
      ng-if = "$root.featureFlags.cardStatus"
      ng-include = "'serverStatusCardHeaderViewCardStatus'"
    )

    .row.modal-tabs.tabs-all.clearfix
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'repository'}"
        ng-click = "changeTab('repository')"
        ng-if = "isTabVisible('repository')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-repository"
          )
        .btn-text Repository
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'ports'}"
        ng-click = "changeTab('ports')"
        ng-if = "isTabVisible('ports')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-ports"
          )
        .btn-text Exposed Ports
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'env'}"
        ng-click = "changeTab('env')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-environment-variable"
          )
        .btn-text Environment Variables
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'commands'}"
        ng-click = "changeTab('commands')"
        ng-if = "isTabVisible('commands')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-start-cmd"
          )
        .btn-text Commands
          br
          | & Packages
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'files'}"
        ng-click = "changeTab('files')"
        ng-if = "isTabVisible('files')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-keys-files"
          )
        .btn-text Files & SSH Keys
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'translation'}"
        ng-click = "changeTab('translation')"
        ng-if = "isTabVisible('translation')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-translation"
          )
        .btn-text Find & Replace
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'logs'}"
        ng-click = "changeTab('logs')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-log"
          )
        .btn-text Logs
      button.btn.btn-radio(
        ng-class = "{'active': selectedTab === 'buildfiles'}"
        ng-click = "changeTab('buildfiles')"
      )
        svg.iconnables
          use(
            xlink:href = "#icons-dockerfile"
          )
        .btn-text Dockerfile

  section.modal-body(
    ng-if = "!isLoading.editServerModal"
  )
    .modal-form(
      ng-include = "'viewFormBuildfiles'"
      ng-show = "selectedTab === 'buildfiles'"
    )
    .modal-form(
      data = "data"
      loading-promises-target = "editServerModal"
      ng-if = "!state.advanced"
      ng-show = "selectedTab === 'repository'"
      stack-selector-form
      state = "state"
    )
    .modal-form(
      ng-if = "!state.advanced"
      ng-include = "'viewFormPorts'"
      ng-show = "selectedTab === 'ports'"
    )
    .modal-form(
      ng-include = "'viewFormEnvironmentVariables'"
      ng-show = "selectedTab === 'env'"
    )
    .modal-form(
      loading-promises-target = "editServerModal"
      ng-if = "!state.advanced"
      ng-show = "selectedTab === 'commands'"
      repository-form
      state = "state"
    )
    .modal-form(
      ng-controller = "ContainerFilesController as CFC"
      ng-if = "!state.advanced"
      ng-include = "'viewFormFiles'"
      ng-show = "selectedTab === 'files'"
    )
    .modal-form(
      ng-if = "state.repo"
      ng-show = "selectedTab === 'translation'"
      translation-rules
    )
    .modal-form.modal-logs(
      ng-class = "{\
        'ace-runnable-dark': !$root.featureFlags.imAfraidOfTheDark,\
        'ace-runnable-light': $root.featureFlags.imAfraidOfTheDark\
      }"
      ng-include = "'viewFormLogs'"
      ng-show = "selectedTab === 'logs'"
    )

  section.modal-body(
    ng-if = "isLoading.editServerModal"
  )
    .spinner-wrapper.spinner-md.in(
      ng-include = "'spinner'"
    )

  footer.modal-footer.clearfix
    //- disabled if no changes
    button.btn.green.btn-spinner(
      ng-class = "{'in': building}"
      ng-click = "editServerForm.$invalid || getUpdatePromise()"
      ng-disabled = "(!state.advanced && (state.selectedStack | selectedStackInvalid)) || !isDockerfileValid()"
      type = "submit"
    )
      //- spinner
      .spinner-wrapper.spinner-sm.spinner-white.in(
        ng-if = "building"
        ng-include = "'spinner'"
      )
      //- if builtâ€¦text should only say "Save"
      span.btn-text(
        ng-if = "!building"
      ) {{ (validation.env.length) ? (validation.env.length) + ' env errors' : 'Save & Rebuild'}}
      span.btn-text(
        ng-if = "building"
      ) Saving
    button.btn.white.btn-cancel(
      ng-click = "cancel()"
      ng-disabled = "building"
      ng-if = "!$root.featureFlags.closeConfigureConfirmation"
      type = "button"
    ) Cancel
    button.btn.white.btn-cancel(
      ng-disabled = "building"
      ng-if = "$root.featureFlags.closeConfigureConfirmation"
      pop-over
      pop-over-template = "closeConfigureModalPopoverView"
      type = "button"
    ) Cancel
