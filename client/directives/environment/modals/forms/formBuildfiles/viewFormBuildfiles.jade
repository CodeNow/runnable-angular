.help-container(
  ng-if = "helpCards.getActiveCard().helpPopover.containerFiles"
)
  .help(
    ng-bind-html = "helpCards.getActiveCard().helpPopover.containerFiles"
  )

.table-actions.table-toggle(
  ng-if = "$root.featureFlags.dockerfileTool"
)
  svg.iconnables.float-left
    use(
      xlink:href = "#icons-lock"
    )
  strong.small.strong Enable Write Access

  small.small
    em.underline.tooltip-plus-wrapper Some tools
      .tooltip-plus.tooltip-tools.bottom(
        ng-include = "'viewTooltipTools'"
        style = "left: -69px; top: 27px;"
      )
    | #{''} are not available with write access enabled.

  //- when locking the dockerfile, prompt with modal template: viewModalLockDockerfile
  //- ✅ if repository (can simple mode) && previous simple build exists (can simple mode)
  label.toggle-wrapper.show-icons(
    loading-promises-target = "editServerModal"
    ng-if = "state.repo && state.instance.attrs.lastBuiltSimpleContextVersion"
    read-only-switch
    state = "state"
  )

  //- ❗️ if non-repository (cannot simple mode…yet) && previous simple build exists (can simple mode)
  label.toggle-wrapper.show-icons(
    loading-promises-target = "editServerModal"
    ng-if = "!state.repo && state.instance.attrs.lastBuiltSimpleContextVersion"
    read-only-switch
    state = "state"
    tooltip = "Write access is always enabled on non-repository containers."
    tooltip-options = "{\"class\":\"bottom bottom-arrow-right\",\"right\":0,\"top\":21}"
  )

  //- ❗️ if repository (can simple mode) && no previous simple build exists (cannot simple mode)
  label(
    loading-promises-target = "editServerModal"
    ng-if = "state.repo && !state.instance.attrs.lastBuiltSimpleContextVersion"
    read-only-switch
    state = "state"
    tooltip = "Write access is always enabled if there’s no build to revert to."
    tooltip-options = "{\"class\":\"bottom bottom-arrow-right\",\"right\":0,\"top\":21}"
  )

  //- ❗️ if non-repository (cannot simple mode…yet) && no previous simple build exists (cannot simple mode)
  label(
    loading-promises-target = "editServerModal"
    ng-if = "!state.repo && !state.instance.attrs.lastBuiltSimpleContextVersion"
    read-only-switch
    state = "state"
    tooltip = "Write access is always enabled on non-repository containers."
    tooltip-options = "{\"class\":\"bottom bottom-arrow-right\",\"right\":0,\"top\":21}"
  )

//- table of current environment variables
//- if dockerfile tool feature flag:
//- state.readOnly = true
.ace-container.ace-build-files(
  ng-class = "{\
    'ace-runnable-dark': !$root.featureFlags.imAfraidOfTheDark,\
    'ace-runnable-light': $root.featureFlags.imAfraidOfTheDark\
  }"
  ng-init = "state.readOnly = $root.featureFlags.dockerfileTool"
)

  .sidebar(
    edit-explorer = "true"
    explorer
    explorer-title = "Build Files"
    file-model = "state.contextVersion"
    loading-promises-target = "editServerModal"
    open-items = "openItems"
    read-only = "!state.advanced"
    root-dir = "state.contextVersion.rootDir"
    show-repo-folder = "true"
  )

  .ace_editor(
    file = "item"
    file-editor
    loading = "loading"
    loading-promises-target = "editServerModal"
    ng-if = "item.state.type === 'File'"
    ng-repeat = "item in openItems.models track by item.id()"
    ng-show = "item === openItems.activeHistory.last()"
    read-only = "!state.advanced"
    state = "state"
  )

  .floating-controls(
    ng-include = "'viewFloatingControls'"
  )
