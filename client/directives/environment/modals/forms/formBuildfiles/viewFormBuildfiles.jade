.help-container(
  ng-if = "SMC.helpCards.getActiveCard().helpPopover.containerFiles"
)
  .help
    button.btn.btn-xs.btn-icon(
      ng-click = "SMC.helpCards.hideActiveCard()"
    )
      svg.iconnables.icons-close
        use(
          xlink:href = "#icons-close"
        )
    span(
      ng-bind-html = "SMC.helpCards.getActiveCard().helpPopover.containerFiles"
    )

.grid-block.shrink.align-center.well.gray.in.row-xxs(
  ng-if = "!SMC.state.advanced || !$root.featureFlags.dockerfileMirroring"
)
  svg.grid-content.row-xxs.shrink.iconnables.icons-dockerfile-lock
    use(
      xlink:href = "#icons-dockerfile-lock"
    )
  .grid-content.row-xxs.text-overflow
    div Unlock Dockerfile
    small.small
      span.span.text-overflow.float-left(
        ng-if = "$root.featureFlags.dockerfileMirroring"
      ) Editing your Dockerfile is for advanced users and is not reversible.

      em.underline(
        ng-if = "!$root.featureFlags.dockerfileMirroring"
        pop-over
        pop-over-hover-trigger
        pop-over-options = "{\"top\":25,\"centered\":true}"
        pop-over-template = "viewTooltipTools"
        pop-over-trigger = "hover"
      ) Some features
      span.text-overflow(
        ng-if = "!$root.featureFlags.dockerfileMirroring"
      ) &nbsp;are not available with editing enabled.

  //- ✅ if repository (can simple mode) && previous simple build exists (can simple mode)
  label.toggle-wrapper.show-icons(
    loading-promises-target = "{{SMC.name}}"
    ng-if = "!$root.featureFlags.dockerfileMirroring"
    read-only-switch
    state = "SMC.state"
  )
  button.btn.btn-sm.white(
    ng-click = "SMC.showAdvancedModeConfirm()"
    ng-if = "$root.featureFlags.dockerfileMirroring"
  )
    svg.iconnables.icons-lock
      use(
        xlink:href = "#icons-lock"
      )
    | Unlock

//- add logic for repository containers only
.grid-block.shrink.align-center.well.gray.in.row-xxs(
  ng-if = "$root.featureFlags.dockerfileMirroring && SMC.state.advanced"
)
  svg.grid-content.row-xxs.shrink.iconnables.icons-sync
    use(
      xlink:href = "#icons-sync"
    )
  .grid-content.row-xxs.text-overflow(
    ng-class = "{'padding-right': SMC.state.isMirroringDockerfile}"
  )
    div Mirror Dockerfile
    small.small(
      ng-if = "SMC.state.isMirroringDockerfile"
    )
      span.span.text-overflow.float-left(
        ng-title = "SMC.state.contextVersion.attrs.buildDockerfilePath"
        ng-if = "state.isMirroringDockerfile"
      ) Mirroring from GitHub: {{ SMC.state.contextVersion.attrs.buildDockerfilePath }}
    small.small(
      ng-if = "!SMC.state.isMirroringDockerfile"
    )
      span.span.text-overflow.float-left Mirror with a Dockerfile from this repo on GitHub.
      //- when there's an error
      //- svg.iconnables.icons-alert-alt.float-left
      //-   use(
      //-     xlink:href = "#icons-alert-alt"
      //-   )
      //- span.span.float-left Error: Dockerfile not found
      //- button.btn.btn-xxs.btn-icon(
      //-   pop-over
      //-   pop-over-hover-trigger
      //-   pop-over-options = "{\"top\":24,\"centered\":true}"
      //-   pop-over-template = "dockerfileMirroringHelpPopover"
      //-   pop-over-trigger = "hover"
      //- )
        svg.iconnables.icons-help
          use(
            xlink:href = "#icons-help"
          )
      //- button.btn.btn-xxs.gray(
        //- internal-modal-helper = "changeMirrorView"
      //- ) Change…

  //- this should open the 'viewModalSync' view when syncing has not been set up
  label.toggle-wrapper
    input.toggle-input(
      ng-model = "SMC.swithcBetweenAdavancedAndMirroring"
      ng-model-options = "{getterSetter: true}"
      type = "checkbox"
    )
    .toggle-group.toggle-sm

//- table of current environment variables
//- if dockerfile tool feature flag:
//- state.readOnly = true
.ace-container.ace-build-files(
  ng-class = "{\
    'ace-runnable-dark': !$root.featureFlags.imAfraidOfTheDark,\
    'ace-runnable-light': $root.featureFlags.imAfraidOfTheDark\
  }"
)

  .sidebar(
    edit-explorer = "true"
    explorer
    explorer-title = "Build Files"
    file-model = "SMC.state.contextVersion"
    loading-promises-target = "editServerModal"
    ng-if = "!SMC.state.isMirroringDockerfile"
    open-items = "SMC.openItems"
    read-only = "!SMC.state.advanced"
    root-dir = "SMC.state.contextVersion.rootDir"
    show-repo-folder = "true"
    get-display-name = "SMC.getDisplayName"
  )

  .ace_editor(
    file = "item"
    file-editor
    loading-promises-target = "editServerModal"
    ng-class = "{'readonly': !SMC.state.advanced || (SMC.state.advanced && SMC.state.isMirroringDockerfile) }"
    ng-if = "item.state.type === 'File'"
    ng-repeat = "item in SMC.openItems.models track by item.id()"
    ng-show = "item === SMC.openItems.activeHistory.last()"
    read-only = "!SMC.state.advanced || (SMC.state.advanced && SMC.state.isMirroringDockerfile)"
    state = "SMC.state"
  )

  .floating-controls(
    ng-include = "'viewFloatingControls'"
  )
